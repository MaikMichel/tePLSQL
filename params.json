{"name":"tePLSQL","tagline":"Template engine 100% PLSQL","body":"# tePLSQL\r\nTemplate Engine for PLSQL.\r\n\r\ntePLSQL is a template engine written completly in PLSQL, generate text output (HTML web pages, e-mails, configuration files, source code, etc.) based on templates. Templates are written with embebed Dynamic PLSQL . \r\n\r\nWith tePLSQL you should prepare the data to display in your PLSQL packages and do business calculations, and then the template displays that already prepared data. In the template you are focusing on how to present the data, and outside the template you are focusing on what data to present.\r\n\r\nNow tePLSQL has the same syntax as the old fashion [Oracle PSP](http://docs.oracle.com/cd/E11882_01/appdev.112/e41502/adfns_psp.htm#ADFNS016) so you do not have to learn any new template language and your PSP will be supported by tePLSQL making some small modifications.\r\n\r\nTemplates are processed and a single block of PLSQPL code being executed dynamically, as does the Oracle PSP loader.  \r\n\r\n- [tePLSQL Elements](#teElements)<br/>\r\n- [Getting started](#getStart)<br/>\r\n    + [Install](#install)<br/>\r\n    + [Compatibility](#compatibility)<br/>\r\n    + [Usage](#usage)<br/>\r\n    + [Templates embebed in objects](#tmplInObjects)<br/>\r\n- [tePLSQL API reference](#apiReference)</br>\r\n- [Contributing](#contributing)<br/>\r\n- [License](#license)\r\n\r\n<a name=\"teElements\"></a>\r\n## tePLSQL Elements\r\n\r\nThe next table list tePLSQL elements that you can use in your templates. \r\n\r\n|Element | Name | Description\r\n|--------|------|------------- \r\n|`<%@ template ... %>` | Template Directive | Characteristics of the template\r\n|`${varName}` | External variable | The variables are defined in a key-value associative array that receives as parameter by the render\r\n|`<%! ... %>` | Declaration block | The declaration for a set of PL/SQL variables that are visible throughout the page, not just within the next BEGIN/END block.\r\n|`<% ... %>` | Code block |A set of PL/SQL statements to be executed when the template is run.\r\n|`<%= ... %>` | Expression block | A single PL/SQL expression\r\n|`\\\\` | Escaped character | Escaping reserved words like `<\\\\% .. %\\\\>` and `q\\\\'[]\\\\'`\r\n| `\\\\n` | New line | Insert new line in the processed template\r\n| `!\\n` | No new line | This element at the end of a line indicates that a new line is not included in the processed template\r\n\r\nThe variables are defined in a key-value associative array that receives as parameter by the render. Within the templates reference to ahce variables via `${varName}`.\r\n\r\ntePSLQL was created when I noticed that there was no separation between business logic and views in my developments. Furthermore it is very useful in code generators template-based, such as Table APIs.\r\n\r\n<a name=\"getStart\"></a>\r\n## Getting started\r\n\r\n<a name=\"install\"></a>\r\n### Install\r\nDownload and compile TEPLSQL.pks and TEPLSQL.pkb. No schema grants are necesary.\r\n\r\n<a name=\"compatibility\"></a>\r\n###Compatibility\r\n\r\ntePLSQL use regular expressions to process templates. Regular expressions were added in Oracle version 10 therefore teplsql works in Oracle Database 10g, 11g and 12c (all editions including XE).\r\n\r\n<a name=\"usage\"></a>\r\n### Usage\r\n\r\n#### Basic Example\r\nWith Text template.\r\n```plsql\r\nDECLARE\r\n   p_template   VARCHAR2 (32000);\r\n   p_vars       teplsql.t_assoc_array;\r\nBEGIN\r\n   p_template  :=\r\n      q'[<%/* Using variables */%>\r\n       Hi ${FullName}!\r\n\r\n       <%/* Using expressions */%>\r\n       Today <%= TO_CHAR(SYSDATE, 'DD-MM-YYYY') %> is a great day!\r\n              \r\n       <% --Using external variable in the query loop\r\n          for c1 in (select username, user_id from all_users where username = upper('${username}')) loop %>          \r\n       Username: <%= c1.username %>, ID:<%= c1.user_id %>.\r\n       <% end loop; %>       \r\n       \r\n       <%/* Escaping chars */%>       \r\n       This is the tePLSQL code block syntax <\\\\% ... %\\\\>\r\n              \r\n       <%/* Regards */%>\r\n       Bye <%=UPPER('${username}')%>.]';\r\n\r\n   --Key-value variables.\r\n   p_vars ('FullName') := 'Oscar Salvador Magallanes';\r\n   p_vars ('username') := 'test';\r\n\r\n   p_template  := teplsql.render (p_template, p_vars);\r\n\r\n   DBMS_OUTPUT.put_line (p_template);\r\nEND;\r\n```\r\n\r\nResult: \r\n\r\n```\r\n    Hi Oscar Salvador Magallanes!\r\n    \r\n    Today 08-09-2015 is a great day!\r\n    \r\n    Username: SYS\r\n    \r\n    This is the tePLSQL code block syntax <% ... %>\r\n    \r\n    Bye SYS.\r\n\r\n    PL/SQL procedure successfully completed.\r\n    Elapsed: 00:00:00.02\r\n```\r\n\r\n\r\n#### HTML Example\r\n\r\n```plsql\r\nDECLARE\r\n   p_template   CLOB;\r\n   p_vars       teplsql.t_assoc_array;\r\nBEGIN\r\n   p_template  :=\r\n      q'[<!DOCTYPE html>\r\n    <html>\r\n      <head>\r\n        <title>${title}</title>\r\n      </head>\r\n      <body>\r\n        <h1> Print Sequence numbers </h1>\r\n        <br>\r\n        <%for i in ${initValue} .. ${lastValue} loop %>\r\n        <%= i %><br>\r\n        <% end loop;%>\r\n        <h1> Print the Odd numbers of sequence </h1>\r\n        <br>    \r\n        <% /*You can insert PLSQL comments as always*/ \r\n        for i in ${initValue} .. ${lastValue}\r\n        loop \r\n            if mod(i,2) <> 0 \r\n            then %>\r\n        <%= i %><br>\r\n        <% end if; \r\n        end loop; %>\r\n      </body>\r\n    </html>]';\r\n\r\n   --Key-value variables.\r\n   p_vars ('title') := 'Number sequence';\r\n   p_vars ('initValue') := 5;\r\n   p_vars ('lastValue') := 20;\r\n\r\n   p_template  := teplsql.render (p_template, p_vars);\r\n\r\n   DBMS_OUTPUT.put_line (p_template);\r\nEND;\r\n```\r\n\r\nResult: \r\n```html\r\n<!DOCTYPE html>\r\n    <html>\r\n      <head>\r\n        <title>Number sequence</title>\r\n      </head>\r\n      <body>\r\n        <h1> Print Sequence numbers </h1>\r\n        <br>\r\n        5<br>\r\n        6<br>\r\n        7<br>\r\n        8<br>\r\n        9<br>\r\n        10<br>\r\n        11<br>\r\n        12<br>\r\n        13<br>\r\n        14<br>\r\n        15<br>\r\n        16<br>\r\n        17<br>\r\n        18<br>\r\n        19<br>\r\n        20<br>\r\n        <h1> Print the Odd numbers of sequence </h1>\r\n        <br>    \r\n        5<br>\r\n        7<br>\r\n        9<br>\r\n        11<br>\r\n        13<br>\r\n        15<br>\r\n        17<br>\r\n        19<br>\r\n      </body>\r\n    </html>\r\n    PL/SQL procedure successfully completed.\r\n    Elapsed: 00:00:00.02\r\n```\r\n\r\n\r\n#### Declaration and instructions\r\n\r\n```plsql\r\n    DECLARE\r\n       p_template   CLOB;\r\n       p_vars       teplsql.t_assoc_array;\r\n    BEGIN\r\n       p_template  := \r\n       q'[<%! lang_name VARCHAR2(10) := 'PL/SQL';\r\n           l_random_number pls_integer := ROUND(DBMS_RANDOM.VALUE (1, 9));\r\n          %> \r\n            The 'sequence' is used in scripting language: <%=lang_name %>.            \r\n            The result of the operation ${someInValue} * <%= l_random_number %> is <%= ${someInValue} * l_random_number %>\r\n        ]';\r\n\r\n       --Key-value variables.   \r\n       p_vars ('someInValue') := 5;   \r\n\r\n       p_template  := teplsql.render (p_template, p_vars);\r\n\r\n       DBMS_OUTPUT.put_line (p_template);\r\n    END;\r\n```\r\n\r\nResult:\r\n\r\n        The 'sequence' is used in scripting language: PL/SQL.\r\n        The result of the operation 5 * 7 is 35\r\n\r\n<a name=\"tmplInObjects\"></a>\r\n#### Templates embebed in objects\r\n\r\ntePLSQL templates can be stored inside PL/SQL program unit spec or bodies.\r\n\r\nIn order to place a template into a program unit you have to create a non-compiled section in the latter with the aid of PL/SQL conditional compilation directives:\r\n\r\n```plsql\r\n    CREATE OR REPLACE PACKAGE test_tmpl\r\n    AS\r\n    $if false $then\r\n    <%! x pls_integer := 1 + 1; %>\r\n    The variable x has the value: <%= x %>\r\n    $end\r\n    END test_tmpl;\r\n```\r\n\r\nProcess the template:\r\n\r\n```plsql\r\n    DECLARE\r\n       result   CLOB;\r\n    BEGIN\r\n       result      := teplsql.process ('test_tmpl');\r\n       DBMS_OUTPUT.put_line (result);\r\n    END;\r\n```\r\n\r\nResult:\r\n\r\n    The variable x has the value: 2\r\n\r\n##### Named Templates\r\n\r\nIn order to store several templates in a single object correctly you must\r\nspecify template characteristics. \r\n\r\nUse the `<%@ template ... %>` directive to specify characteristics of the template:\r\n\r\n- What is the name of the template\r\n- What is the version of the template\r\n- Any other user-defined feature\r\n\r\nThe characteristics are a pair of key-value separated by commas\r\n\r\n###### Syntax\r\n\r\n`<%@ template key=value, key2=value2 %>`\r\n\r\nThe syntax is case-sensitive but space-insensitive. Values with blanks are not allowed.\r\n\r\n###### Example\r\n\r\nDefining the template name\r\n\r\n```plsql\r\n    CREATE OR REPLACE PACKAGE test_tmpl\r\n    AS\r\n\r\n    $if false $then\r\n    <%@ template \r\n        name=adding,\r\n        version=0.1 %>\r\n    <%! x pls_integer := 1 + 1; %>\r\n    Processing template ${template_name} with version ${template_version}\r\n    The variable x has the value: <%= x %>\r\n    $end\r\n\r\n    $if false $then\r\n    <%@ template name=subtracting, version=0.1, revision=3 %>\r\n    <%! y pls_integer := 1 - 1; %>\r\n    Processing template ${template_name} with version ${template_version} and revision ${template_revision}\r\n    The variable y has the value: <%= y %>\r\n    $end\r\n\r\n    END test_tmpl;\r\n```\r\n\r\nProcess the \"subtracting\" template:\r\n\r\n```plsql\r\n    DECLARE\r\n       result   CLOB;\r\n    BEGIN\r\n       result      := teplsql.process (p_object_name => 'test_tmpl', p_template_name => 'subtracting');\r\n       DBMS_OUTPUT.put_line (result);\r\n    END;\r\n```\r\n\r\nResult:\r\n\r\n    Processing template subtracting with version 0.1 and revision 3\r\n    The variable y has the value: 0\r\n\r\n\r\n<a name=\"apiReference\"></a>\r\n## tePLSQL API reference\r\n\r\n### RENDER\r\n\r\nRenders the template received as parameter. \r\n\r\n#### Syntax\r\n\r\n```plsql\r\n   FUNCTION render (p_template IN CLOB, p_vars IN t_assoc_array DEFAULT null_assoc_array )\r\n      RETURN CLOB;\r\n```\r\n\r\n#### Parameters\r\n\r\n|Parameter | Description\r\n|----------|------------\r\n|p_template | The template's body.\r\n|p_vars | The template's arguments.\r\n| return CLOB | The processed template.\r\n\r\n### PROCESS\r\n\r\nRceives the name of the object, usually a package, which contains an embedded template. The template is extracted and is rendered with `render` function \r\n\r\n#### Syntax\r\n\r\n```plsql\r\n   FUNCTION process (p_object_name   IN VARCHAR2\r\n                   , p_vars          IN t_assoc_array DEFAULT null_assoc_array\r\n                   , p_template_name IN VARCHAR2 DEFAULT NULL\r\n                   , p_object_type   IN VARCHAR2 DEFAULT 'PACKAGE'\r\n                   , p_schema        IN VARCHAR2 DEFAULT NULL )\r\n      RETURN CLOB;\r\n```\r\n\r\n#### Parameters\r\n\r\n|Parameter | Description\r\n|----------|------------\r\n|p_object_name | The name of the object (usually the name of the package).\r\n|p_vars | The template's arguments.\r\n|p_template_name | The name of the template.\r\n|p_object_type | The type of the object (PACKAGE, PROCEDURE, FUNCTION...).\r\n|p_schema | The object's schema name.\r\n| return CLOB | The processed template.\r\n\r\n### PRINT\r\n\r\nPrints received data into the buffer\r\n\r\n#### Syntax\r\n\r\n```plsql\r\n   PROCEDURE PRINT (p_data IN CLOB);\r\n\r\n   PROCEDURE p (p_data IN CLOB);\r\n\r\n   PROCEDURE PRINT (p_data IN VARCHAR2);\r\n\r\n   PROCEDURE p (p_data IN VARCHAR2);\r\n\r\n   PROCEDURE PRINT (p_data IN NUMBER);\r\n\r\n   PROCEDURE p (p_data IN NUMBER);\r\n```\r\n\r\n#### Parameters\r\n\r\n|Parameter | Description\r\n|----------|------------\r\n|p_data | The data to print into buffer\r\n\r\n<a name=\"contributing\"></a>\r\n## Contributing\r\n\r\nIf you have ideas, get in touch directly.\r\n\r\nPlease inser at the bottom of your commit message the following line using your name and e-mail address .\r\n\r\n    Signed-off-by: Your Name <you@example.org>\r\n\r\nThis can be automatically added to pull requests by committing with:\r\n\r\n    git commit --signoff\r\n\r\n<a name=\"license\"></a>\r\n## License\r\nCopyright 2015 Oscar Salvador Magallanes \r\n\r\ntePLSQL is under MIT license. \r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}